ドキュメント：[本家サイト](https://laravel.com/docs/11.x/eloquent#configuring-eloquent-strictness) [日本語](https://readouble.com/laravel/11.x/ja/eloquent.html#configuring-eloquent-strictness)

バグ又は N+1 問題を防止してくれる3つの機能について見ていきます。これらは個別に指定することもできますが、3つの機能をまとめてオンにする事ができますので、実際はそうすると良いでしょう。この機能に引っかかると、エラー（例外）となります。

Providers/AppServiceProvider.php
```php
use Illuminate\Database\Eloquent\Model;

class AppServiceProvider extends ServiceProvider

    public function boot()
    {
        // 一括で設定する
        // 本番環境以外で有効にする
        Model::shouldBeStrict(! $this->app->isProduction());

        // 個別に設定も可能だが、上記で一括設定が楽
        Model::preventSilentlyDiscardingAttributes(! $this->app->isProduction());
        Model::preventAccessingMissingAttributes(! $this->app->isProduction());
        Model::preventLazyLoading(! $this->app->isProduction());
    }
```

## preventSilentlyDiscardingAttributes
`$fillable` に列挙されてない項目が投入されたら、エラーとなる機能です。この機能を使用していない場合は、単にスルーされて処理が続行されます。プログラマが綴りを間違えた時など、何もエラーが出ないのは、バグの原因ともなります。この機能をオンにすることで、そのような事を防ぐ事ができます。

実は、`$guarded` でも機能しますが、ここでは、`$fillable` に特化して記述しています。

確認用コード
```php
$user = new User;
$user->fill(['hoge' => 'bar']);
```

## preventAccessingMissingAttributes
この機能は、モデルのデータで、「(1) 存在しないプロパティにアクセスしようとして」且つ「(2) そのモデルがDBに存在する時」のみ機能します。言い換えれば、DBに保存していないモデルは、この機能の対象にはなりません。

確認用コード（DB には、1件以上データがある前提）
```php
// ケース1
$user = User::first();
$user->emailll;  // email の綴りミス

// ケース2
$user = User::select('id', 'name')->first();
$user->email;  // select() に email を追加し忘れ

// エラーにはならないケース
$user = new User([
    'name' => 'taro',
]);

$user->nameee;  // 綴りミスだが、エラーにはならない
```

この機能を使用していない場合、単に値は `null` となって、何事も無かったかの如くスルーされていましたが、この機能をオンにするとエラーとなります。

## preventLazyLoading
DB の N+1 を検知し、発生していればエラーとしてくれる機能です。
N+1 問題のページに記載してありますので、そちらを参照して下さい。