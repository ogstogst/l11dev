ドキュメント：[本家サイト](https://laravel.com/docs/11.x/eloquent#query-scopes) [日本語](https://readouble.com/laravel/11.x/ja/eloquent.html#query-scopes)

クエリースコープ には、ローカルスコープとグローバルスコープの2つがあります。頻繁に使うのは、ローカルスコープで、グローバルスコープは普通は滅多に使いません。ここでは、ローカルスコープで紹介させていただきます。

## ローカルスコープ
データベースへの操作を行う際、条件指定を使い回す時（又はより明示的なメソッドがほしい時）に利用されます。
モデル側に、scopeXxxx の命名規則でメソッドを記述します。

### scope 機能を使わない場合
```php
$posts = Post::where('is_open', 1)->get();
```

### scope 機能を使う場合

Models/Post
```php
class Post extends Model
{
    public function scopeOnlyOpen($query) {
        $query->where('is_open', 1);
    }
}
```

コントローラ等で
```php
$posts = Post::onlyOpen()->get();
```

### その他補足

パラメータを引き渡すこともできます。
```php
$users = User::ageAbove(15)->get();

class User extends Model
{
    public function scopeAgeAbove($query, $age = 20) {
        $query->where('age', '>', $age);
    }
}
```

return は必要ありません。
```php
class Post extends Model
{
    public function scopeOnlyOpen($query) {
        // ↓ 下記 return は不要。
        return $query->where('is_open', 1);
    }
}
```

## グローバルスコープ
グローバルスコープは、クエリ発行時に常に適用されるものです。使い所が無いわけではありませんが、普通は滅多に使わない為、ここでは省略させていただきます。